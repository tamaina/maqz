---
title: SVG Telopper v2.0
description: v2では、テロップの管理をブラウザの管理画面から行います。
layout: index
rank: 2
---
SVG Telopperは、OBSの配信でWeb技術を使ってテロップを表示したい！という願望から生まれました。

以下のようなことができます！
- SVGを使う
- CSSを使う
- テロップをCSSでアニメーション
- JavaScriptで動的に内容を変更
- スタイルを使いまわしたい
- テロップを簡単に切り替えたい
- タイムアウト（時間指定）で自動的に次の文章へ移動させたい
- ブラウザUI上で簡単操作

## 使い方
### 事前に用意するもの
[**Node.js**](https://nodejs.org/ja/)が必要です（v11で動作確認済み）。

また、[OBS WebSocket](https://github.com/Palakis/obs-websocket/releases/tag/4.4.0)をインストールすることで、OBSとのちょっとした連携を行うことができます。

### ダウンロード
[リリースページ](https://github.com/tamaina/svg-telopper/releases)から「svg-telopper-v2.x.x.zip」をダウンロードし解凍。

### インストール
`install.bat`を実行（Windows向け）

### サーバーを開始
SVG Telopper v2は、サーバー（ソフトウェア）を核にして動作します。まずはサーバーを起動しましょう。

`Svg-Telopper.bat`を実行（Windows向け）

### 設定画面にアクセスする
http://localhost:4044/setting にブラウザでアクセスします。

画面幅広めで表示することを推奨します。

### 描画インスタンスにアクセスする
`http://localhost:4044/render#:id`にブラウザや**OBSのブラウザソース**でアクセスします。  
`:id`は適当なIDです。(例: `hoge`…`http://localhost:4044/render#hoge`)

指定しなければ適当な数字が割り当てられ、ブラウザでアクセスすると自動的にURLが変更されるのですが、**OBSではURLは自動的に変更・保存されない**ので手動で設定する必要があります。

### 設定を変更
`.config.yaml`は設定ファイルです。  
URLや使うデータベースを変更したい場合、`.config.yaml`を編集してサーバーを起動しなおします。

## 操作方法
設定画面で各種操作を行うと、描画インスタンスやOBSにその場で反映されます。

設定画面はカラム型のレイアウトをしています。

### シーン
OBSに接続されている場合、「シーン」カラムが表示されます。

各シーンを選択すると、そのシーンで表示されている描画インスタンスが隣の「ソース」カラムに表示されます。  
また、スタジオモードが有効の場合、プレビューが切り替わります。

シーンを選択した状態でもう一度クリックすると、シーンが切り替わります。

### ソース
描画インスタンスが一覧されます。各描画インスタンスを選択すると、隣の「描画インスタンス設定（上段）」と「クエリ（下段）」が切り替わります。

**プリセット**は、使いまわすことができるクエリの設定のことです。

### 描画インスタンス設定（上段）
右から2列目の上段は、描画インスタンスの設定を行えます。

線から上の「表示するクエリ」は、現在表示しているクエリを表示します。また、クリックしてクエリIDを選択すると即、表示を切り替えられます。

線から下の各種設定は、「適用」ボタンを押すことではじめて適用されます。「削除」を押すと選択されている描画インスタンスが削除されます。

- 「表示順を逆転」をオン/オフすると、字幕切り替え時に今度表示する字幕が消えゆく字幕の上になるか下になるかを選択できます。
- 「クライアント幅/高」は、ブラウザソースの内側の表示領域（「クライアント」）の幅・高さをどのような値にするか設定できます。初期設定は「幅`80vw`/高`80vh`」です。

### クエリ（下段）
クエリは、字幕ひとつひとつの設定のことです。選択すると右のクエリ編集カラムが切り替わり、編集できるようになります。

描画インスタンスを1つだけ選択しているとき、ドラッグアンドドロップで並び替えできます。

クエリを選択した状態でもう一度クリックすると、描画インスタンスの表示をそのクエリに切り替えます。

右上の「+」をクリックするとクエリが追加されます。

### クエリ編集
#### 置き換え対象と文字列
SVG Telopperの基本思想は**SVG内の文字列を「置き換える」**ことです。上段の「置き換え対象」と「文字列」で、置き換えの組を設定できます。  
「フィールドを追加/削除」をすると、置き換えの組を増減できます。

#### プリセット
描画インスタンス内のクエリを編集しているときのみ表示され、使用するプリセットを指定できます。

#### タイムアウト
**ミリ秒**で指定します。この時間経った後、リストの次の字幕を表示します。

#### クラス
HTMLクラスを追記できますが、この機能はv2.0.1では動作確認していません。

#### アンカー
主にSVGで、どのテキストアンカーを設定したかを記入します。

#### 枠に合わせて変形
SVG Telopperではx方向の縮小は自動で行われますが、これを有効にすると表示領域を埋めるようにも変形するようになります。

#### 編集
各種コードを編集できます。描画インスタンスをブラウザで開いて、F12ツールを表示するとデバッグできます。

##### HTML/SVG
HTMLやSVGを設定します。inkscapeで編集したファイルの中身をコピー・ペーストしたり、自分で何かしらのHTMLコードを書いたりできます。

##### 関数
JavaScriptの関数を記入できます。このコードは[このように](https://github.com/tamaina/svg-telopper/blob/master/src/clients/scripts/stw.ts#L308-L311)挿入されます。

`this`は描画インスタンスのクラス、`subtitle`は字幕のElement、`query`はこのクエリ、`preset`はプリセットのクエリを指します。

##### スタイルシート
CSSを記述・挿入できます。  
`.stw-q-${クエリ/プリセットID}`を必ず親要素として指定してください。

#### 取り消す
プリセットを新規に作成しているとき表示されます。

#### 保存
**保存**しないと編集内容が失われます。

**プリセット名を変更したい場合は、下のプリセット名を変更してこの保存ボタンを押してください。**

#### 削除
選択中のクエリを削除します。

#### 描画インスタンスにコピー
クリックすると描画インスタンス一覧が表示され、クリックすると表示中の設定が適用されたクエリが選択中の描画インスタンスに追加されます。

#### プリセットに登録
プリセット名を記入してこのボタンを押すと、表示中の設定がプリセットに新規に登録されます。  

## スクリーンショット
![image](https://user-images.githubusercontent.com/7973572/53215085-71918c80-3692-11e9-8b21-64c95441897c.png)  
![image](https://user-images.githubusercontent.com/7973572/53215150-adc4ed00-3692-11e9-9ff0-a03f2925fdad.png)

## 謝辞
i18nの方式はMisskeyを参考にしました。
